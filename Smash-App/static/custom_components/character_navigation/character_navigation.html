<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/paper-styles/color.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/app-layout/app-layout.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">

<link rel="import" href="../character_select/character_select.html">
<link rel="import" href="../character_sheet/character_sheet.html">
<link rel="import" href="../character_matchup/character_matchup.html">
<link rel="import" href="../styles/icons.html">

<dom-module id="character-navigation">
    <template>
        <style is="custom-style" include="iron-flex iron-flex-alignment">
            app-header {
                height: 64px;
                background-color: var(--paper-grey-600);
                color: white;
            }
            app-drawer {
                z-index: 10;
            }
            #search_button {
               right: 8px;
               position: absolute;
               height: 40px;

            }
            #toolbar_text {
               font-size: 32px;
               margin-top: 8px;
               margin-left: 8px;
	        }
	        #toolbar_text:hover {
	           cursor:default;
	        }
            #secondary_toolbar_text {
                font-size: 16px;
                margin: auto;
                padding-left: 16px;
            }
	        #drawer_div {
	            height: 100%;
	            overflow: auto;
	            background-color: var(--paper-grey-600);
	            color: white;
	        }
	        .toolbar_button {
               margin-top: 12px;
               margin-bottom: 12px;
	        }
        </style>

        <iron-media-query query="(max-width: 450px)" query-matches="{{ is_mobile }}"></iron-media-query>
        <app-header id="menu_toolbar" reveals>
            <app-toolbar>
                <div class="layout horizontal wrap">
                    <paper-icon-button id="menu_button" icon="smash:menu" class="toolbar_button" on-tap="toggle_drawer"></paper-icon-button>
                    <div main-title id="toolbar_text">{{ toolbar_text }}</div>
                    <div id="secondary_toolbar_text">{{ secondary_toolbar_text }}</div>
                    <paper-icon-button id="search_button" icon="smash:search"class="toolbar_button"></paper-icon-button>
                </div>
            </app-toolbar>
        </app-header>
        <app-drawer id="navigation_drawer">
             <div id="drawer_div">
                <div role="listbox">
				    <paper-item on-tap="set_character_select_view">Character Select</paper-item>
				    <paper-item on-tap="set_character_matchup_view">Character Matchup</paper-item>
				</div>
             </div>    
        </app-drawer>
        <template is="dom-if" if="{{ character_select_bool }}">
            <character-select id="character_select" is_mobile="{{ is_mobile }}"></character-select>
        </template>
        <template is="dom-if" if="{{ character_sheet_bool }}">
            <character-sheet tech_counter="{{ tech_counter }}" class="character_sheet" character="{{ character }}"></character-sheet>
        </template>
        <template is="dom-if" if="{{ character_matchup_bool }}">
            <character-matchup character_one="{{ character_one }}" character_two="{{ character_two }}"></character-matchup>
       </template>
    </template>
    <script>
        Polymer({
            is: 'character-navigation',
            
            properties: {
                is_mobile: {
                    type: Boolean,
                    value: false
                },
                character: {
                    type: String,
                    value: null
                },
                toolbar_text: {
                	type: String,
                	value: 'SSBM Vault'
                },
                secondary_toolbar_text: {
                	type: String,
                	value: ''
                },
                character_select_bool: {
                	type: Boolean,
                	value: false,
                },
                character_sheet_bool: {
                    type: Boolean,
                    value: false,
                },
                character_matchup_bool: {
                    type: Boolean,
                    value: false,
                }
            },

            listeners: {
                'character_selected': 'character_selected',
                'change_toolbar_text': 'change_toolbar_text',
                'set_character_matchup_view': 'set_character_matchup_view'
            },

            ready: function() {
            	this.character_select_bool = true;
            },
            
            set_character_matchup_view: function(event) {
            	this.toggle_drawer();
            	this.character = undefined;
            	this.change_toolbar_text({detail:{primary: 'SSBM Vault', secondary: ''}});
            	this.character_select_bool = false;
            	this.character_sheet_bool = false;
            	this.character_matchup_bool = true;
            	//if(event.detail.character_one && event.detail.character_two) {
                if(true) {
            		//this.character_one = event.detail.character_one;
            		//this.character_two = event.detail.character_two;
        		    this.character_one = {};
                    this.character_two = {};
                    this.character_one.name = 'Fox';
                    this.character_two.name = 'Falco';
            		this.character_one.character_sheet_image = '../../images/character_select_images/fox.jpg';
            		this.character_two.character_sheet_image = '../../images/character_select_images/falco.jpg';
                }
            	else {
            		this.character_one = 'dummy';
            		this.character_two = 'dummy';
            	}
            },

            toggle_drawer: function() {
                this.$.navigation_drawer.toggle();
            },

            change_toolbar_text: function(event) {
            	this.toolbar_text = event.detail.primary;
            	this.secondary_toolbar_text = ((event.detail.secondary !== undefined) || (event.detail.secondary !== '')) ? event.detail.secondary : '';
            },

            set_character_select_view: function() {
            	this.tech_counter = -1;
            	this.character = null;
                this.character_sheet_bool = false;
                this.character_matchup_bool = false;
                this.character_select_bool = true;
            	this.toggle_drawer();
            	this.change_toolbar_text({detail:{primary: 'SSBM Vault', secondary: ''}});
            },

            character_selected: function(event) {
            	this.character_sheet_bool = true;
            	this.character_matchup_bool = false;
            	this.character_select_bool = false;
                this.character = event.detail;
                this.change_toolbar_text({detail:{primary: this.character.name, secondary: ''}});
            }
        });
    </script>
</dom-module>